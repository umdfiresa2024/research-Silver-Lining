---
title: "How does the opening of the Silver Line affect housing costs?"
author: "2024 FIRE198 Sustainability Analytics"
format: gfm
editor: visual
---

## Team Members

Raphael Coronel, Taylor Woods, Brian Huang, Joseph Tang

## Research Question

***How did the opening/announcement of the Silver Line affect housing costs?***

## Background

This research project aims to address one question: How has the expansion of public transportation, such as the Silver Line, affected housing prices in the Washington D.C Metropolitan Area? The Silver Line has two significant expansions in Fairfax and Loudoun County that are broken up into 2 phases. The first phase is 2014-2022, where the metro line connects McLean, VA to Reston, VA. The second phase is 2022 to the present, where the metro line continues towards Ashburn, VA. Understanding the effect of the presence of public transportation, like metro lines, especially the Silver Line, on the prices of homes can have a serious effect on the way public transportation is perceived by policy makers and homebuyers. Public transit plays a vital role in shaping urban development patterns, which influence accessibility and property values. As public transportation networks expand, they often improve connectivity, reducing commute times and increasing access to employment centers. This can lead to an increase in demand for housing in neighborhoods served by transit, potentially driving up housing prices. Alternatively, transit expansion can spur development in neglected areas, resulting in the displacement of current residents. This research question can be answered by comparing the difference in price between houses that are not in proximity to the Silver Line, houses that are within the proximity of phase 1 in 2014, and houses that are within the proximity of phase 2 in 2022. The results of these findings will help policymakers make more informed decisions about transit investments, urban planning and affordable housing initiatives. On top of that, it will help inform equitable development strategies to ensure transportation improvements benefit all residents and their community conditions.

Current research shows the effects of building metros, lines, and other forms of transport and how it increases the amount of people who participate in using public transport. We know the silver line has developed in two phases thus affecting the people’s usage of it who live in the area. Additionally, we have information about how house prices change throughout the course of months and years based on the location they are in. We know how housing prices are changed based on the implementation of public transport, but we have a gap in information for the Washington D.C Metropolitan area. We know from past research that houses tend to increase in price based on their “closeness” to the station (Forrest et al., 1996). This is also proven by the Atlanta Beltline where the outcome was that homes increased in value by 30-40 percent if they were within a mile of the BeltLine (Girard, 2018). By looking at the two phases of the Silver Line, we can examine how the surrounding houses have fluctuated in price. This will help us get an understanding of how our area has adjusted due to more opportunity to use these services and how implementation in the future can change the housing market. Additionally, we can observe how the distance from the transportation in our area is a cause of changes in home costs by looking at how other forms of public transport have affected their nearby areas and apply our datasets and research to look at the effects in the Washington D.C Metropolitan area.

## Data

Our data source is the ZHVI (Zillow Home Value Index) which collects the house price of different areas.

Clean data here.

```{r}
#| warnings: false
#| message: false
library("tidyverse")
library("glue")

df <- read.csv("dfdmv_with_treatment_NEW.csv")

```

```{r}
df2 <- df %>% filter( df$CountyName == "Loudoun County" | df$CountyName == "Fairfax County")
```

```{r}
df3<- df2 %>% mutate(date=as.Date(date)) %>% 
  mutate(open_2014=ifelse(date>as.Date("2014-07-01"),1,0))%>%
  mutate(open_2022=ifelse(date>as.Date("2022-11-01"),1,0))

```

## Preliminary Results

## Question 1: What is the frequency of this data frame?

Answer: once a month

## Question 2: What is the cross-sectional (geographical) unit of this data frame?

Answer: zip code

```{r}
names(df3)

```

Treatment variable: station_open

Outcome variable: Price

The box plot below illustrates the price distributions across our two treated and one untreated groups.

```{r}

df_2014 <- df3 %>%
  filter(zip_in_2014==1) %>%
  group_by(date) %>%
  summarize(average_price_2014 = mean(Price))

df_2022 <- df3 %>%
  filter(zip_in_2022==1) %>%
  group_by(date) %>%
  summarize(average_price_2022 = mean(Price))

df_years <- df_2014 %>% left_join(df_2022, by="date")

df_control <- read.csv("dfsilvercontrol.csv")

df_control2 <- df_control %>%
  group_by(date) %>%
  summarize(average_price_ctrl = mean(Price))

df_control2$date <- as.Date(df_control2$date)

df_combined <- df_control2 %>% left_join(df_years, by="date")

df_boxplot <- df_combined %>%
  pivot_longer(
    cols = c('average_price_ctrl', 'average_price_2014', 'average_price_2022'),     # Specify the columns to pivot
    names_to = "group",                    # New column for group (control, 2014, 2022)
    values_to = "value"                    # New column for values
  )

ggplot(df_boxplot, aes(group,value)) +
  geom_boxplot()
```

```{r}
model1<-lm(Price ~ (zip_in_2014*open_2014)+(zip_in_2022*open_2022), data=df3)

summary(model1)
```

## Question 5: What is the predicted value of the outcome variable when treatment=0?

Answer: 559209

## Question 6: What is predicted value of the outcome variable when treatment=1?

Answer:

2014:

559209+46069+110466+59012=774756

2022:

559209+(-198980)+186716+(-60827)=486118

## Question 7: What is the equation that describes the linear regression above? Please include an explanation of the variables and subscripts.

Answer:

$$
Price_{it} = \beta_0 \times (\text{zip_in_2014}\times \text{open_2014})+ \beta_1 \times \text{zip_in_2014}_i + \beta_3 \times \text{open_2014}_t + \\ \gamma_1 (\text{zip_in_2022}_i \times \text{open_2022}_t)+\gamma_2 (\text{zip_in_2022}_i \times \text{open_2022}_t)+\gamma_3 (\text{zip_in_2022}_i \times \text{open_2022}_t) +\epsilon_{it}
$$

## Question 8: What fixed effects can be included in the regression? What does each fixed effects control for? Please include a new equation that incorporates the fixed effects.

Answer: Month, Year, CountyName, BedroomCnt, RegionName (zip code)

## Question 9: What is the impact of the treatment effect once fixed effects are included?

Answer:

```{r}
model2<-lm(Price ~ (zip_in_2014*open_2014)+(zip_in_2022*open_2022)+ as.factor(Month) + as.factor(Year) + as.factor(CountyName) + as.factor(BedroomCnt),data=df3)
summary(model2)

```

# Questions for Week 5

## Question 10: In a difference-in-differences (DiD) model, what is the treatment GROUP?

Answer: zip_in_2014, zip_in_2022

## Question 11: In a DiD model, what are the control groups?

Answer: other houses in Fairfax and Loudoun county.

## Question 12: What is the DiD regression equation that will answer your research question?

## Question 13: Run your DiD regressions below. What are the results of the DiD regression?

When the first part of the rail opened, the house prices increased by 7008.

When the second part of the rail opened, the house prices decreased by 59862.

## Question 14: What are the next steps of your research?

Look at impact of bedroom counts, as well as other potential variables like mortgage rates to further minimize the confounding variables.

## Preliminary Graph

```{r}
ggplot()+
  geom_line(data=df_combined, aes(x=date,y=average_price_2014,col="Expansion Phase 1")) +
  geom_line(data=df_combined, aes(x=date,y=average_price_2022,col="Expansion Phase 2")) +
  geom_line(data=df_combined, aes(x=date,y=average_price_ctrl,col="Control Group")) +
  geom_vline(xintercept = as.numeric(as.Date("2014-07-01")), color="blue",linetype="dashed") +
  geom_vline(xintercept = as.numeric(as.Date("2022-11-01")), color="purple",linetype="dashed") +
  scale_color_manual("Legend", values=c("red", "blue","purple")) +
  labs(title = "ZHVI Values of Virginia Zip Codes Near the Silver Line Expansion", x = "Date", y = "Price")
```

## References

Zillow Home Value Index. \[Dataset\]. Zillow Inc. https://www.zillow.com/research/data/

Forrest, D., Glen, J., & Ward, R. (1996). The impact of a light rail system on the structure of house prices: a hedonic longitudinal study. Journal of Transport economics and Policy, 15-29.

Girard, P. (2018). URBAN REDEVELOPMENT AND HOUSING VALUES: A CASE STUDY OF THE ATLANTA BELTLINE.
